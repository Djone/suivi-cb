<div class="card">
  <p-card>
    <p-table
      #dt
      [value]="categories"
      [paginator]="true"
      [rows]="10"
      [rowsPerPageOptions]="[10, 20, 50, 100]"
      [showCurrentPageReport]="true"
      currentPageReportTemplate="{first} √† {last} sur {totalRecords} cat√©gories"
      [globalFilterFields]="['label', 'financialFlowLabel', 'statusLabel']"
      [tableStyle]="{ 'min-width': '50rem' }"
      styleClass="p-datatable-gridlines p-datatable-striped">

      
      <ng-template pTemplate="caption">
        <div class="flex align-items-center justify-content-between flex-wrap gap-3">
          <!-- Bouton pour ajouter une cat√©gorie -->
          <p-button
            label="Nouvelle cat√©gorie"
            icon="pi pi-plus"
            (onClick)="createCategory()"
            styleClass="p-button-success">
          </p-button>

          <!-- Champ de recherche -->
          <input
            pInputText
            type="text"
            (input)="applyFilterGlobal($event, 'contains')"
            placeholder="üîç Rechercher une cat√©gorie..."
            class="w-full"
            style="max-width: 300px;"
          />
        </div>
      </ng-template>

      <!-- En-t√™tes de colonnes avec filtres -->
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="label" style="width: 40%">
            Libell√©
            <p-sortIcon field="label" />
          </th>
          <th pSortableColumn="financialFlowId" style="width: 25%">
            Flux financier
            <p-sortIcon field="financialFlowId" />
          </th>
          <th pSortableColumn="isActive" style="width: 15%">
            Statut
            <p-sortIcon field="isActive" />
          </th>
          <th style="width: 20%">Actions</th>
        </tr>
      </ng-template>

      <!-- Corps du tableau -->
      <ng-template pTemplate="body" let-category>
        <tr>
          <td>{{ category.label }}</td>
          <td>
            <p-tag
              [value]="category.financialFlowLabel"
              [severity]="category.financialFlowId === 1 ? 'success' : 'danger'">
            </p-tag>
          </td>
          <td>
            <p-tag
              [value]="category.statusLabel"
              [severity]="getSeverity(category.isActive)">
            </p-tag>
          </td>
          <td>
            <div class="flex align-items-center gap-2">
              <p-button
                icon="pi pi-pencil"
                (onClick)="editCategory(category)"
                styleClass="p-button-rounded p-button-text p-button-info"
                pTooltip="√âditer"
                tooltipPosition="top">
              </p-button>
              <p-inputSwitch
                [ngModel]="category.isActive"
                [trueValue]="1"
                [falseValue]="0"
                (onChange)="toggleActive(category, $event)"
                pTooltip="Activer/D√©sactiver"
                tooltipPosition="top">
              </p-inputSwitch>
            </div>
          </td>
        </tr>
      </ng-template>

      <!-- Message si aucune donn√©e -->
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="4" class="text-center">Aucune cat√©gorie trouv√©e.</td>
        </tr>
      </ng-template>
    </p-table>
  </p-card>
</div>
 
