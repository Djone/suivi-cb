<div class="form-container">
    <h2 class="form-header">Ajouter {{ financialFlowName === 'revenu' ? 'un revenu' : 'une dépense'  }}</h2>
    <p>Compte : {{ accountName  }}</p>
    <form [formGroup]="transactionForm" (ngSubmit)="onSubmit()">
      <!-- Description -->
      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Description</mat-label>
        <mat-icon matPrefix>description</mat-icon>
        <input matInput formControlName="description" />
      </mat-form-field>

      <!-- Date -->
      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Date</mat-label>
        <input matInput [matDatepicker]="picker" formControlName="date" />
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
      </mat-form-field>
  
      <!-- Montant -->
      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Montant</mat-label>
        <mat-icon matPrefix>euro</mat-icon>
        <input matInput type="number" formControlName="amount" />
        <mat-error *ngIf="transactionForm.get('amount')?.hasError('required')">
            Le montant est requis.
          </mat-error>
      </mat-form-field>
  
      <!-- Sous-catégorie
      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Sous-catégorie</mat-label>
        <mat-icon matPrefix>category</mat-icon>
        <input
            matInput
            formControlName="subcategory_id"
            [matAutocomplete]="auto"
            placeholder="Rechercher une sous-catégorie"
        />

        <mat-autocomplete #auto="matAutocomplete">
            <mat-option *ngFor="let subcategory of filteredSubcategories" [value]="subcategory.description">
            {{ subcategory.description }}
            </mat-option>
        </mat-autocomplete>
      </mat-form-field> -->
      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Sous-catégorie</mat-label>
        <mat-icon matPrefix>category</mat-icon>
        <mat-select formControlName="subCategoryId">
          <mat-option *ngFor="let subCategory of subcategories" [value]="subCategory.id">
            {{ subCategory.label }}
            </mat-option>
        </mat-select>
      </mat-form-field>
  
      <!-- Compte -->
      <mat-form-field appearance="fill" class="invisible">
      <!-- <mat-form-field appearance="fill" class="full-width"> -->
        <mat-label>Compte</mat-label>
        <mat-icon matPrefix>credit_card</mat-icon>
        <input matInput type="number" formControlName="accountId" [value]="accountId" />
      </mat-form-field>
  
      <!-- Type de catégorie-->
      <mat-form-field appearance="fill" class="invisible">
      <!-- <mat-form-field appearance="fill" class="full-width"> -->
        <mat-label>Type</mat-label>
        <mat-icon matPrefix>compare_arrows</mat-icon>
        <input matInput type="number" formControlName="financialFlowId" [value]="financialFlowId" />
      </mat-form-field>
  
      <!-- Bouton de soumission -->
      <button mat-raised-button color="primary" type="submit" [disabled]="!transactionForm.valid">
        Ajouter Transaction
      </button>

      <!-- Bouton pour reset le formulaire -->
      <button mat-raised-button (click)="resetForm()">
        Réinitialiser
      </button>
    </form>
  </div>

  <app-transaction-list></app-transaction-list>